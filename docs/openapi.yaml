openapi: 3.1.1

info:
  title: Drone Ops & Compliance API
  description: >
    Advisory-only drone preflight compliance tools including airspace checks,
    weather assessment, TFR awareness, and go/no-go checklist generation.
  version: "0.6.0"

servers:
  - url: https://drone-ops-compliance.onrender.com

paths:
  /healthz:
    get:
      operationId: health_check
      summary: Health check
      responses:
        "200":
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  service:
                    type: string
                  timestamp_utc:
                    type: string

  /version:
    get:
      operationId: get_version
      summary: Service version info
      responses:
        "200":
          description: Version information
          content:
            application/json:
              schema:
                type: object
                properties:
                  service:
                    type: string
                  version:
                    type: string
                  git_commit:
                    type: string
                  timestamp_utc:
                    type: string

  /tools/check_airspace:
    post:
      operationId: check_airspace
      summary: Analyze airspace and LAANC requirements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                longitude:
                  type: number
                altitude_ft_agl:
                  type: number
                flight_datetime:
                  type: string
      responses:
        "200":
          description: Airspace analysis result
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    additionalProperties: true
                  meta:
                    type: object
                    additionalProperties: true

  /tools/analyze_weather_conditions:
    post:
      operationId: analyze_weather_conditions
      summary: Analyze current weather and Part 107 visibility/cloud clearance
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                longitude:
                  type: number
                flight_datetime:
                  type: string
      responses:
        "200":
          description: Weather analysis result
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    additionalProperties: true
                  meta:
                    type: object
                    additionalProperties: true

  /tools/check_tfrs:
    post:
      operationId: check_tfrs
      summary: Check for active Temporary Flight Restrictions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                longitude:
                  type: number
                radius_nm:
                  type: number
                flight_datetime:
                  type: string
      responses:
        "200":
          description: TFR check result
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    additionalProperties: true
                  meta:
                    type: object
                    additionalProperties: true

  /tools/generate_preflight_checklist:
    post:
      operationId: generate_preflight_checklist
      summary: Generate go/no-go preflight checklist
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                mission_type:
                  type: string
                airspace_data:
                  type: object
                  additionalProperties: true
                weather_data:
                  type: object
                  additionalProperties: true
                tfr_data:
                  type: object
                  additionalProperties: true
      responses:
        "200":
          description: Checklist result
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    additionalProperties: true
                  meta:
                    type: object
                    additionalProperties: true

  /tools/generate_laanc_links:
    post:
      operationId: generate_laanc_links
      summary: Provide FAA-approved LAANC provider links
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                longitude:
                  type: number
      responses:
        "200":
          description: LAANC links
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    additionalProperties: true
                  meta:
                    type: object
                    additionalProperties: true
